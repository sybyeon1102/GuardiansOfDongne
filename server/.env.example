# ============================
# Database (PostgreSQL)
# ============================
# 형식: postgresql+psycopg2://USER:PASSWORD@HOST:PORT/DBNAME
DATABASE_URL=postgresql+psycopg2://USER:PASSWORD@localhost:5432/DBNAME


# ============================
# 모델 체크포인트 경로 (Prep_v3 기반)
# (server/behavior_inference_server.py 기준 상대 경로 또는 절대 경로)
# ============================

# 1차 모델 (정상/이상 판정용, Prep_v3 Model_1.pt)
# 비워두면 기본값: server/detector.ckpt
DET_CKPT_PATH=

# 2차 모델 (이상 행동 라벨 분류용, Prep_v3 Model_2.pt)
# 비워두면 기본값: server/classifier.ckpt
CLS_CKPT_PATH=


# ============================
# 이상행동 판정 파라미터 (옵션)
# - 기본값 괜찮으면 생략 가능
# - 환경별로 튜닝하고 싶을 때만 조절
# ============================

# EMA 평활 계수 (0~1, 클수록 반응 빠름)
# behavior_inference_server.py 에서는 DET_EMA_ALPHA 라는 이름으로 읽는다.
DET_EMA_ALPHA=0.3

# START / END 임계값 (EMA 기준)
DET_START_THR=0.80    # 이 값 이상이면 '이상' 쪽으로 기울었다고 봄
DET_END_THR=0.55      # 이 값 이하로 떨어지면 '정상으로 돌아왔다'고 봄

# voting 윈도우 크기 및 최소 표 수
DET_VOTE_WIN=5            # 최근 5 윈도우
DET_MIN_START_VOTES=4     # 그 중 True(이상) 표가 최소 몇 개 이상이면 START
DET_MIN_END_VOTES=4       # False 표 수 기준 END 조건에 사용

# 이벤트 최소 길이 / 쿨다운 (초 단위)
DET_MIN_EVENT_SEC=2.0     # 최소 2초 이상 지속되어야 진짜 이벤트로 인정
DET_COOLDOWN_SEC=2.0      # END 이후 최소 2초는 다시 START 안 나도록 쿨다운


# ============================
# CORS 설정 (UI용)
# ============================
# React UI 등에서 직접 이 서버를 호출할 수 있도록 허용할 Origin 목록.
# 쉼표로 구분해서 여러 개 입력 가능.
# 현재 서버 코드는 allow_origins=["*"] 로 설정되어 있어,
# ALLOWED_ORIGINS 값은 참고용 예시이며 실제로는 사용되지 않는다.
ALLOWED_ORIGINS=http://localhost:3000,http://127.0.0.1:3000


# ============================
# Tracking (YOLO + DeepSort + optional ReID / Global ID)
# ============================
# - TRACKING_ENABLED=false 이면 /tracking 엔드포인트는 Snapshot만 생성하고
#   tracking_snapshot.objects_json 은 항상 빈 배열("[]")로 저장된다.
# - TRACKING_ENABLED=true 이면 YOLO11n + DeepSORT 기반 기본 트래킹이 동작한다.
# - ReID / Global ID 는 아래 플래그로 별도 제어한다.

# 기본 트래킹 on/off
TRACKING_ENABLED=false

# YOLO11n + DeepSORT 기본 파라미터
# 모델 경로: 절대 경로 또는 server/behavior_inference_server.py 기준 상대 경로
TRACK_YOLO_WEIGHTS=./yolo11n.pt
TRACK_CONF_THRES=0.5
TRACK_IOU_THRES=0.7
TRACK_MAX_AGE=30

# ReID / Global ID (osnet_x1_0 등 ReID 모델이 준비됐을 때만 true 로 변경)
TRACK_ENABLE_REID=false
TRACK_ENABLE_GLOBAL_ID=false

# ReID 모델 설정 (TRACK_ENABLE_REID=true 일 때만 사용)
TRACK_REID_MODEL_NAME=osnet_x1_0
#TRACK_REID_MODEL_PATH=./osnet_x1_0_imagenet.pth

# cosine distance threshold (작을수록 더 엄격)
TRACK_REID_COSINE_THRES=0.25
