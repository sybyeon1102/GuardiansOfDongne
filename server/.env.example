# ============================
# Database (PostgreSQL)
# ============================
# 형식: postgresql+psycopg2://USER:PASSWORD@HOST:PORT/DBNAME
DATABASE_URL="postgresql+psycopg2://USER:PASSWORD@localhost:5432/DBNAME"


# ============================
# 모델 체크포인트 경로 (Prep_v3 기반)
# (server/behavior_inference_server.py 기준 상대 경로 또는 절대 경로)
# ============================

# 1차 모델 (정상/이상 판정용, Prep_v3 Model_1.pt)
#   - 예: Prep_v3/Model_1/Train/weight/Model_1.pt 를 서버에서 접근 가능한 위치로 복사해둔 뒤 지정
DET_CKPT_PATH=

# 2차 모델 (이상 행동 라벨 분류용, Prep_v3 Model_2.pt)
#   - 예: Prep_v3/Model_2/Train/weight/Model_2.pt 를 서버에서 접근 가능한 위치로 복사해둔 뒤 지정
CLS_CKPT_PATH=

# (옵션) meta.json 경로
# - 현재 서버 런타임에서는 ckpt 내부의 meta 를 우선 사용한다.
# - 필요하면 오프라인 분석/검증용으로만 사용.
#DET_META_PATH="~/data/god/det/meta.json"
#CLS_META_PATH="~/data/god/cls/meta.json"


# ============================
# Kakao API 설정
# ============================
# - 모든 카톡은 "에이전트별 Kakao 토큰"으로만 나간다.
# - 이 URL은 기본값이 이미 코드에 있으므로, 보통은 굳이 설정 안 해도 됨.
#   필요하면 override 용도로만 사용.
KAKAO_SEND_URL="https://kapi.kakao.com/v2/api/talk/memo/default/send"


# ============================
# 이상행동 판정 파라미터 (옵션)
# - 기본값 괜찮으면 생략 가능
# - 환경별로 튜닝하고 싶을 때만 조절
# ============================

# EMA 평활 계수 (0~1, 클수록 반응 빠름)
EMA_ALPHA="0.3"

# START / END 임계값 (EMA 기준)
DET_START_THR="0.80"    # 이 값 이상이면 '이상' 쪽으로 기울었다고 봄
DET_END_THR="0.55"      # 이 값 이하로 떨어지면 '정상으로 돌아왔다'고 봄

# voting 윈도우 크기 및 최소 표 수
DET_VOTE_WIN="5"            # 최근 5 윈도우
DET_MIN_START_VOTES="4"     # 그 중 True(이상) 표가 최소 몇 개 이상이면 START
DET_MIN_END_VOTES="4"       # False/None 표 수 기준 END 조건에 사용

# 이벤트 최소 길이 / 쿨다운 (초 단위)
DET_MIN_EVENT_SEC="2.0"     # 최소 2초 이상 지속되어야 진짜 이벤트로 인정
DET_COOLDOWN_SEC="2.0"      # END 이후 최소 2초는 다시 START 안 나도록 쿨다운


# ============================
# CORS 설정 (UI용)
# ============================
# React UI 등에서 직접 이 서버를 호출할 수 있도록 허용할 Origin 목록.
# 쉼표로 구분해서 여러 개 입력 가능.
# 개발 환경 예시: 로컬 프론트엔드 (3000 포트)
ALLOWED_ORIGINS="http://localhost:3000,http://127.0.0.1:3000"

# 배포 환경에서는 실제 도메인으로 교체:
#ALLOWED_ORIGINS="https://your-frontend.example.com"


# ============================
# Tracking (YOLO + DeepSort) 플래그
# ============================
# 지금은 서버 엔드포인트(/tracking)까지만 있고
# 실제 YOLO/DeepSort 추론은 아직 붙어 있지 않다.
# - TRACKING_ENABLED=false 여도 /tracking 엔드포인트는 정상 응답을 돌려주며,
#   tracking_snapshot.objects_json 은 빈 배열("[]")로 저장된다.
# - 나중에 YOLO weight 를 준비하고 modeling.tracking.yolo_deepsort 를 붙이면
#   이 값을 true 로 바꿔서 활성화할 수 있다.
TRACKING_ENABLED="false"

# (예정) 추후 YOLO/DeepSort 구현 시에 쓸 후보 키들 (지금은 주석만 남겨둠)
#TRACK_YOLO_WEIGHTS="~/data/god/tracking/yolov8n.pt"
#TRACK_DEVICE="cuda:0"      # 또는 "cpu"
#TRACK_CONF_THRESH="0.5"
#TRACK_IOU_THRESH="0.4"
#TRACK_RESIZE_W="640"
#TRACK_MAX_AGE="30"
#TRACK_N_INIT="3"
#TRACK_MAX_DIST="0.2"
